{% extends 'admin/master.html' %}
{% block body %}
{{ super() }}

{% if current_user.is_authenticated %}
<!-- <link rel="stylesheet" href="/static/css/all.css"> -->
<!-- <link rel="stylesheet" href="/static/css/bootstrap-table.min.css"> -->
<style>
        table {
          font-family: arial, sans-serif;
          border-collapse: collapse;
          width: 100%;
        }
        
        td, th {
          border: 1px solid #dddddd;
          text-align: left;
          padding: 8px;
        }
        
        tr:nth-child(even) {
          background-color: #dddddd;
        }
        </style>
        <section class="content-header">
            <h1>Kết quả bầu cử </h1>
            <h2 class="breadcrumb">
                <a href="/admin/statistical/export_excel/{{data['id']}}" class="btn btn-primary btn-flat pull-left">Kết xuất file excel</a>
            </h2>
        </section>
<section class="content">

<h3>Tên cuộc bầu cử: <b>{{data['content']['title']}}</b>
</br>
Tổng số phiếu bầu: {{data['content']['total']}}
</br>
Số phiếu bầu hợp lệ: {{data['content']['num_valid']}}
</br>
Số phiếu bầu không hợp lệ: {{data['content']['num_invalid']}}
</br></h3>
        <h2>Kết quả chi tiết</h2>
        <table>
            <thead>
                <tr>                   
                    <th class="column-header">STT</th>
                    <th class="column-header">Họ và tên</th>
                    <th class="column-header">Tỷ lệ trúng cử</th>
                </tr>
            </thead>

            <tbody>
                    {%  for dt in data['table']  %}
                    <tr>
                        <td class="col-id">
                                {{dt['order_number']}}
                            </td>
                    <td class="col-title">
                            {{dt['full_name']}}
                        </td>

                    <td class="col-total">
                        {% if data['content']['num_valid'] == 0%}
                        0%
                        {% else %}
                        {{ (dt['total_vote']/data['content']['num_valid'] * 100)|round(2)}}% ({{dt['total_vote']}}/{{data['content']['num_valid']}})
                        {% endif %}    
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    
</section>
<script src="/static/js/jquery-3.3.1.min.js"></script>
<script src="/static/js/popper.min.js"></script>
<script src="/static/js/bootstrap.min.js"></script>
<!-- /.content -->
{% else %}

<center>
    <section class="content" style="color: white">
        <div class="col-sm-12">
            <h1>Admin Manager</h1>
            <!-- <p class="lead">
                Authentication
            </p>
            <p>
                This example shows how you can use Flask-Admin in an admin template, <br> here I used AdminLTE and <a href="https://pythonhosted.org/Flask-Security/index.html" target="_blank">Flask-Security</a> for authentication.
            </p> -->
            {% if not current_user.is_authenticated %}
            <meta http-equiv="Refresh" content="0; url={{ url_for('security.login') }}" />

            <!-- email: <b>admin</b> <br> -->
            <!-- password: <b>admin</b> <br> -->
            <br>
            <p>
                <a class="btn btn-primary" href="{{ url_for('security.login') }}">Login</a>
            </p>
            {% endif %}
            <br>
            <p>
                <a class="btn btn-primary" href="/"><i class="glyphicon glyphicon-chevron-left"></i> Back</a>
            </p>
        </div>


    </section>
</center>

<br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br>
{% endif %}

{% endblock body %}